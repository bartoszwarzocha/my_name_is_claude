{
  "$schema": "https://json-schema.org/draft-07/schema#",
  "version": "1.0.0",
  "description": "Advanced Checkpoint & State Management System - Revolutionary rollback capabilities",
  "lastUpdated": "2025-10-05",

  "checkpointLevels": {
    "agent_execution": {
      "name": "Agent Execution Checkpoint",
      "description": "Capture state before agent execution",
      "scope": "single_agent",
      "autoCreate": true,
      "retention": "session",
      "contents": [
        "agent_context",
        "input_parameters",
        "environment_state",
        "todolist_state"
      ]
    },
    "quality_gate": {
      "name": "Quality Gate Checkpoint",
      "description": "Capture state before quality validation",
      "scope": "workflow",
      "autoCreate": true,
      "retention": "24h",
      "contents": [
        "code_changes",
        "test_results",
        "quality_metrics",
        "conversation_history"
      ]
    },
    "commit_preparation": {
      "name": "Commit Preparation Checkpoint",
      "description": "Capture state before git commit",
      "scope": "project",
      "autoCreate": true,
      "retention": "7d",
      "contents": [
        "git_diff",
        "staged_files",
        "conversation_context",
        "agent_decisions"
      ]
    },
    "manual": {
      "name": "Manual Checkpoint",
      "description": "User-created checkpoint at any time",
      "scope": "custom",
      "autoCreate": false,
      "retention": "30d",
      "contents": [
        "full_project_state",
        "conversation_history",
        "code_state",
        "context_state"
      ]
    }
  },

  "semanticRewind": {
    "enabled": true,
    "description": "Smart rewind with semantic understanding",
    "capabilities": [
      "rewind_to_before_bug",
      "rewind_to_last_working_state",
      "rewind_to_before_refactoring",
      "rewind_to_commit_point"
    ],
    "semanticMarkers": {
      "before_bug": "Last checkpoint before test failure or error",
      "last_working": "Most recent checkpoint with all tests passing",
      "before_refactoring": "Checkpoint before code restructuring began",
      "commit_point": "Checkpoint at last git commit"
    }
  },

  "autoCheckpointTriggers": {
    "before_agent_execution": {
      "enabled": true,
      "condition": "always",
      "level": "agent_execution"
    },
    "before_quality_gate": {
      "enabled": true,
      "condition": "quality_check_triggered",
      "level": "quality_gate"
    },
    "before_commit": {
      "enabled": true,
      "condition": "git_commit_initiated",
      "level": "commit_preparation"
    },
    "before_deployment": {
      "enabled": true,
      "condition": "deployment_initiated",
      "level": "quality_gate"
    },
    "before_refactoring": {
      "enabled": true,
      "condition": "refactoring_detected",
      "level": "commit_preparation"
    },
    "on_test_failure": {
      "enabled": true,
      "condition": "test_failure_detected",
      "level": "agent_execution"
    }
  },

  "rollbackStrategies": {
    "granular": {
      "description": "Rollback only specific agent's work",
      "scope": "agent",
      "preserves": ["other_agents_work", "unrelated_changes"]
    },
    "workflow": {
      "description": "Rollback entire workflow to checkpoint",
      "scope": "multi_agent",
      "preserves": ["unrelated_workflows"]
    },
    "full": {
      "description": "Complete project rollback",
      "scope": "project",
      "preserves": []
    },
    "selective": {
      "description": "Cherry-pick what to rollback",
      "scope": "custom",
      "preserves": ["user_selected"]
    }
  },

  "checkpointStorage": {
    "location": ".claude/checkpoints/",
    "format": "json_with_diffs",
    "compression": true,
    "encryption": false,
    "maxSize": "100MB",
    "autoCleanup": true,
    "retentionPolicy": {
      "agent_execution": "session_end",
      "quality_gate": "24h",
      "commit_preparation": "7d",
      "manual": "30d"
    }
  },

  "multiAgentCoordination": {
    "enabled": true,
    "perAgentCheckpoints": true,
    "workflowStatePreservation": true,
    "parallelAgentSynchronization": true,
    "selectiveRollback": true,
    "description": "Each agent gets its own checkpoint for granular rollback"
  },

  "integrations": {
    "todoWrite": {
      "enabled": true,
      "checkpointOnTaskStart": true,
      "checkpointOnTaskComplete": false,
      "restoreTasksOnRollback": true
    },
    "git": {
      "enabled": true,
      "createGitStash": true,
      "trackCommitPoints": true,
      "syncWithGitHistory": true
    },
    "qualityGates": {
      "enabled": true,
      "autoCheckpointBeforeGate": true,
      "autoRollbackOnFailure": false,
      "requireManualDecision": true
    }
  },

  "uiCommands": {
    "create": "claude checkpoint create [name]",
    "list": "claude checkpoint list",
    "restore": "claude checkpoint restore [id]",
    "rewind": "claude checkpoint rewind [semantic_marker]",
    "diff": "claude checkpoint diff [id1] [id2]",
    "delete": "claude checkpoint delete [id]"
  },

  "notifications": {
    "onCheckpointCreate": true,
    "onRollback": true,
    "onAutoCleanup": false,
    "channel": "console"
  }
}
