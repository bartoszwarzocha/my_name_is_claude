# v3.5.0 Features Guide - Background Task Management

**My Name Is Claude Framework v3.5.0 | Release Date: October 5, 2025**

## What's New in v3.5.0

Version 3.5.0 introduces the **Background Task Management System** - a comprehensive infrastructure for running long-running analysis tasks without blocking your development workflow.

### Why This Matters

**Before v3.5.0:**
- Security scans, performance profiling, and comprehensive testing blocked your development
- Manual execution required for quality checks
- No automated continuous monitoring
- Workflow interruptions for long-running tasks

**After v3.5.0:**
- Tasks run in background with process isolation
- Automatic triggering via file changes, git hooks, scheduled tasks
- Multi-channel notifications keep you informed
- Continue developing while tasks execute
- Enterprise-grade reliability with crash recovery

## Key Features

### üéØ Non-Blocking Task Execution

Run long-running tasks in isolated processes without blocking your main workflow.

**Features:**
- Process isolation for safety
- Concurrent task limiting (default: 5)
- Task timeout management
- Resource monitoring (CPU, memory)
- State persistence for crash recovery

**Example:**
```bash
# Start background task manager
python .ai-tools/background/background_task_manager.py start

# Continue developing - tasks run in background
# Notifications inform you of results
```

### üìä Comprehensive Analysis Engines

Three built-in analysis engines for automatic code quality monitoring:

#### Security Scanner
- **Tools:** Bandit (Python), npm audit (Node.js), Safety (Python deps)
- **Detects:** Vulnerabilities, insecure code patterns, dependency issues
- **Triggers:** File changes, scheduled intervals
- **Notifications:** Critical/high severity issues

#### Performance Profiler
- **Analysis:** Cyclomatic complexity (Radon), file sizes, code metrics
- **Detects:** High complexity functions, large files, performance issues
- **Triggers:** Test runs, manual execution
- **Recommendations:** Refactoring suggestions

#### Code Quality Analyzer
- **Tools:** Pylint (Python), ESLint (JavaScript/TypeScript)
- **Enforces:** Code style, best practices, quality standards
- **Triggers:** Git commits, scheduled intervals
- **Reports:** Errors, warnings, style violations

### üîî Multi-Channel Notifications

Get informed through your preferred notification channel:

**Console:**
- Real-time logging with severity indicators
- Colored output with emoji icons (‚úÖ ‚ö†Ô∏è ‚ùå üö®)

**Desktop:**
- Platform-specific notifications
- Linux (notify-send), macOS (osascript), Windows (toast)

**File:**
- JSON-based structured logging
- Automatic rotation (10MB, 5 files)

**Email:**
- HTML and plain text formats
- SMTP with TLS support
- Template-based messaging

### üîç Auto-Triggering System

Automatic task execution based on events:

#### File Watching
Monitor source files and trigger tasks on changes:
```json
{
  "paths": ["**/*.py", "**/*.js", "**/*.ts"],
  "exclude_paths": ["**/node_modules/**", "**/.venv/**"]
}
```

**Features:**
- Glob pattern matching
- MD5 hash-based change detection
- 1-second debouncing
- Event types: created, modified, deleted

#### Git Hooks
Integrate with your git workflow:
```bash
# Install hooks
python .ai-tools/background/background_task_manager.py install-hooks
```

**Supported Hooks:**
- **pre-commit** - Code analysis before commit
- **post-commit** - Security scan after commit
- **pre-push** - Tests and performance profile before push
- **post-merge** - Analysis after merge

#### Scheduled Tasks
Run tasks at specific times using cron expressions:
```json
{
  "name": "daily_security_scan",
  "schedule": "0 2 * * *"
}
```

### ‚ö° Smart Task Scheduling

Intelligent priority-based queue with adaptive learning:

**Priority Levels:**
- **CRITICAL (1000)** - Security issues, critical errors
- **HIGH (100)** - Tests, important analysis
- **MEDIUM (10)** - Code quality, performance
- **LOW (1)** - Documentation, technical debt

**Adaptive Learning:**
- Automatically boosts priority for frequently failing tasks
- Reduces priority for quick-completing tasks
- Learns from last 100 executions per task type
- Real-time adjustment based on patterns

## Getting Started

### Quick Setup (5 minutes)

**1. Background Task Management is included - no installation needed!**

**2. Optional: Install analysis tools**
```bash
# Python tools
pip install bandit safety radon pylint

# JavaScript tools
npm install -g eslint

# Windows desktop notifications
pip install win10toast
```

**3. Configuration**

All settings in `.claude/config/background-tasks.json`:
```json
{
  "enabled": true,
  "execution": {
    "max_concurrent_tasks": 5,
    "task_timeout_seconds": 3600
  },
  "task_types": {
    "security_scan": {
      "enabled": true,
      "auto_trigger": {
        "on_file_change": true,
        "interval_minutes": 30
      }
    }
  }
}
```

**4. Start the manager**
```bash
python .ai-tools/background/background_task_manager.py start
```

**5. Install git hooks (optional)**
```bash
python .ai-tools/background/background_task_manager.py install-hooks
```

### Basic Usage

#### Manual Task Execution

Run analyses on demand:
```bash
# Security scan
python .ai-tools/background/core/analysis_engine.py security --output results.json

# Performance profile
python .ai-tools/background/core/analysis_engine.py performance --output results.json

# Code quality
python .ai-tools/background/core/analysis_engine.py code --output results.json

# Run all
python .ai-tools/background/core/analysis_engine.py all --output results.json
```

#### Check System Status
```bash
python .ai-tools/background/background_task_manager.py status
```

Output:
```json
{
  "running": true,
  "queue": {
    "current_size": 3,
    "running_tasks": 2
  },
  "git_hooks": {
    "pre-commit": true,
    "post-commit": true
  }
}
```

## Common Use Cases

### Use Case 1: Continuous Security Monitoring

**Goal:** Automatically scan for vulnerabilities during development

**Setup:**
1. Enable security_scan in configuration
2. Configure file watching
3. Set desktop notifications for critical issues

**Configuration:**
```json
{
  "task_types": {
    "security_scan": {
      "enabled": true,
      "auto_trigger": {
        "on_file_change": true
      },
      "priority": "high",
      "notification_on_issues": true
    }
  },
  "notification_system": {
    "channels": {
      "desktop": {
        "enabled": true,
        "min_severity": "error"
      }
    }
  }
}
```

**Result:**
- Security scans run automatically when you modify code
- Desktop alerts for critical/high severity issues
- Continue development without interruption

### Use Case 2: Pre-Commit Quality Gates

**Goal:** Ensure code quality before committing

**Setup:**
1. Install git hooks
2. Configure code_analysis for pre-commit

**Commands:**
```bash
python .ai-tools/background/background_task_manager.py install-hooks
```

**Configuration:**
```json
{
  "triggers": {
    "git_hooks": {
      "enabled": true,
      "pre_commit": ["code_analysis"],
      "post_commit": ["security_scan"]
    }
  }
}
```

**Result:**
- Code analysis runs before each commit
- Security scan after commit completes
- Non-blocking (commits never blocked)
- Notifications for issues found

### Use Case 3: Automated Test Execution

**Goal:** Run tests automatically after code changes

**Setup:**
1. Enable test_runner
2. Configure 10-second debounce
3. Set notifications for failures only

**Configuration:**
```json
{
  "task_types": {
    "test_runner": {
      "enabled": true,
      "auto_trigger": {
        "on_file_change": true,
        "debounce_seconds": 10
      },
      "priority": "high",
      "notification_on_complete": false,
      "notification_on_issues": true
    }
  }
}
```

**Result:**
- Tests run 10 seconds after last file change
- Prevents rapid re-execution during active coding
- Desktop notifications only for failures
- Background execution doesn't interrupt workflow

## Configuration Examples

### Example 1: Minimal Configuration

Perfect for getting started:
```json
{
  "enabled": true,
  "execution": {
    "max_concurrent_tasks": 3
  },
  "task_types": {
    "security_scan": {
      "enabled": true,
      "auto_trigger": {
        "on_file_change": true
      }
    }
  },
  "notification_system": {
    "channels": {
      "console": {
        "enabled": true
      }
    }
  }
}
```

### Example 2: Full-Featured Configuration

Enterprise-ready setup:
```json
{
  "enabled": true,
  "execution": {
    "max_concurrent_tasks": 5,
    "task_timeout_seconds": 3600,
    "process_isolation": true,
    "max_retries": 3
  },
  "resource_limits": {
    "max_memory_mb": 2048,
    "max_cpu_percent": 50
  },
  "task_types": {
    "security_scan": {
      "enabled": true,
      "auto_trigger": {
        "on_file_change": true,
        "interval_minutes": 30
      },
      "priority": "high",
      "notification_on_complete": true,
      "notification_on_issues": true
    },
    "performance_profile": {
      "enabled": true,
      "auto_trigger": {
        "on_test_run": true
      },
      "priority": "medium"
    },
    "code_analysis": {
      "enabled": true,
      "auto_trigger": {
        "on_commit": true
      },
      "priority": "low"
    },
    "test_runner": {
      "enabled": true,
      "auto_trigger": {
        "on_file_change": true,
        "debounce_seconds": 10
      },
      "priority": "high"
    }
  },
  "triggers": {
    "file_watch": {
      "enabled": true,
      "paths": ["**/*.py", "**/*.js", "**/*.ts"],
      "exclude_paths": ["**/node_modules/**", "**/.venv/**"]
    },
    "git_hooks": {
      "enabled": true,
      "pre_commit": ["code_analysis"],
      "post_commit": ["security_scan"],
      "pre_push": ["test_runner", "performance_profile"]
    }
  },
  "notification_system": {
    "enabled": true,
    "channels": {
      "console": {"enabled": true},
      "desktop": {"enabled": true, "min_severity": "warning"},
      "file": {"enabled": true},
      "email": {"enabled": false}
    }
  }
}
```

### Example 3: Python-Focused Configuration

Optimized for Python projects:
```json
{
  "enabled": true,
  "task_types": {
    "security_scan": {
      "enabled": true,
      "auto_trigger": {
        "on_file_change": true
      }
    },
    "code_analysis": {
      "enabled": true,
      "auto_trigger": {
        "on_commit": true
      }
    },
    "test_runner": {
      "enabled": true,
      "auto_trigger": {
        "on_file_change": true,
        "debounce_seconds": 10
      }
    }
  },
  "triggers": {
    "file_watch": {
      "enabled": true,
      "paths": ["**/*.py"],
      "exclude_paths": ["**/.venv/**", "**/venv/**", "**/__pycache__/**"]
    }
  }
}
```

## Troubleshooting Quick Guide

### Tasks Not Running

**Check:**
1. Manager is running: `python .ai-tools/background/background_task_manager.py status`
2. Configuration enabled: `"enabled": true`
3. Task type enabled: `"security_scan": {"enabled": true}`
4. File patterns match: Verify `paths` in configuration

**Debug:**
```bash
tail -f project_archive/logs/background-tasks.log
```

### Notifications Not Working

**Desktop:**
- Linux: `sudo apt install libnotify-bin`
- macOS: Check Terminal notification permissions
- Windows: `pip install win10toast`

**Email:**
- Verify SMTP settings
- Use environment variables for credentials
- Test with manual notification

### High Resource Usage

**Solutions:**
1. Reduce concurrent tasks: `"max_concurrent_tasks": 3`
2. Lower resource limits: `"max_cpu_percent": 30`
3. Increase timeouts: `"task_timeout_seconds": 7200`

## Performance Tips

**Optimize Queue Performance:**
```json
{
  "execution": {
    "max_concurrent_tasks": 3,  // Start low, increase as needed
    "task_timeout_seconds": 1800  // Prevent premature termination
  }
}
```

**File Watcher Optimization:**
```json
{
  "triggers": {
    "file_watch": {
      "paths": ["src/**/*.py"],  // Specific paths only
      "exclude_paths": ["**/test_*.py"]  // Exclude unnecessary files
    }
  }
}
```

**Debouncing:**
```json
{
  "test_runner": {
    "auto_trigger": {
      "debounce_seconds": 10  // Adjust based on typing speed
    }
  }
}
```

## Best Practices

### Configuration Best Practices

1. **Start Conservative** - Begin with fewer concurrent tasks (2-3)
2. **Monitor First** - Watch resource usage for 1-2 days before increasing limits
3. **Tune Timeouts** - Set based on actual task durations in your environment
4. **Enable Gradually** - Start with manual execution, then add auto-triggers

### Notification Best Practices

1. **Console Always** - Keep console notifications enabled for debugging
2. **Desktop Selectively** - Only for warnings and errors
3. **Email Sparingly** - Critical issues only
4. **File Logging** - Always enabled for audit trail

### Task Configuration Best Practices

1. **Security: High Priority** - Security scans should run quickly
2. **Tests: Auto-Trigger** - Run after file changes with debouncing
3. **Code Analysis: Low Priority** - Can wait, runs on commit
4. **Performance: Manual/Scheduled** - Resource-intensive, scheduled off-hours

## Migration from Previous Versions

### From v3.4.0 (Hooks Framework)

Background Task Management **complements** the Hooks Framework:
- Hooks Framework: Pre/post agent execution hooks
- Background Tasks: Long-running analysis without blocking

**Can be used together:**
```json
{
  "hooks": {
    "pre_agent": ["validate-requirements.py"]
  },
  "background_tasks": {
    "security_scan": {"enabled": true}
  }
}
```

### From v3.3.0 (Cost Optimization)

Background tasks respect cost optimization settings:
- Analysis tools run locally (no API costs)
- Priority system prevents resource waste
- Scheduled tasks run during off-peak hours

## Next Steps

### Learn More

- **[Background Task Management](../ai-tools/background-task-management.md)** - Complete guide
- **[CHANGELOG](../../CHANGELOG.md)** - Full release notes for v3.5.0
- **Technical Documentation** - `.ai-tools/background/README.md`

### Integration Examples

- **[Development Workflow](../workflows/development-workflow.md)** - Integrate with standard workflow
- **[Team Collaboration](../workflows/team-collaboration.md)** - Multi-developer setup
- **[Crisis Management](../workflows/crisis-management.md)** - Emergency procedures

### Advanced Topics

- Custom task types
- Plugin system integration
- Distributed task execution (future)
- Web dashboard (future)

## Summary

Background Task Management System v3.5.0 provides enterprise-grade infrastructure for continuous code quality monitoring without interrupting your development workflow.

**Quick Benefits:**
- ‚úÖ Develop while tasks run in background
- ‚úÖ Automatic security, performance, quality checks
- ‚úÖ Multi-channel notifications keep you informed
- ‚úÖ Git integration for pre/post commit analysis
- ‚úÖ Smart scheduling learns from task patterns
- ‚úÖ Enterprise reliability with crash recovery

**Getting Started:**
```bash
# 1. Start the manager
python .ai-tools/background/background_task_manager.py start

# 2. Install git hooks (optional)
python .ai-tools/background/background_task_manager.py install-hooks

# 3. Continue developing - tasks run automatically
```

For detailed configuration and advanced features, see the [complete documentation](../ai-tools/background-task-management.md).
