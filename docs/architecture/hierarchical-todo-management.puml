@startuml
!theme materia
title Claude Code Multi-Agent Framework v2.0.0 - Hierarchical TODO Management System

skinparam rectangle {
    BackgroundColor<<Epic>> #FF6B6B
    BackgroundColor<<Feature>> #4ECDC4
    BackgroundColor<<Task>> #45B7D1
    BackgroundColor<<Subtask>> #FFA07A
    BackgroundColor<<Agent>> #E6E6FA
    BackgroundColor<<TodoWrite>> #98FB98
}

package "ðŸ“‹ Hierarchical TODO Structure" {

    rectangle "EPIC LEVEL\n(4-12 weeks)" as Epic <<Epic>> {
        note right : **business-analyst** ownership\nBusiness strategy & requirements\nStakeholder coordination

        rectangle "Epic: User Authentication System Overhaul" as E1
        rectangle "Epic: Advanced Analytics Dashboard" as E2
        rectangle "Epic: Mobile Application Development" as E3
    }

    rectangle "FEATURE LEVEL\n(1-3 weeks)" as Feature <<Feature>> {
        note right : **product-manager** ownership\nFeature specifications\nMVP scoping & prioritization

        rectangle "Feature: OAuth2 Implementation" as F1
        rectangle "Feature: Multi-Factor Authentication" as F2
        rectangle "Feature: User Profile Management" as F3
        rectangle "Feature: Real-time Analytics" as F4
        rectangle "Feature: Custom Dashboards" as F5
        rectangle "Feature: Mobile UI Components" as F6
    }

    rectangle "TASK LEVEL\n(4 hours - 3 days)" as Task <<Task>> {
        note right : **software-architect** ownership\nTechnical architecture\nComponent design & planning

        rectangle "Task: JWT Token Management" as T1
        rectangle "Task: OAuth2 Server Setup" as T2
        rectangle "Task: MFA UI Components" as T3
        rectangle "Task: Analytics Data Pipeline" as T4
        rectangle "Task: Dashboard API Design" as T5
        rectangle "Task: Mobile Navigation" as T6
    }

    rectangle "SUBTASK LEVEL\n(2-8 hours)" as Subtask <<Subtask>> {
        note right : **Implementation Agents** ownership\nConcrete development work\nSpecific coding tasks

        rectangle "Subtask: JWT Unit Tests" as S1
        rectangle "Subtask: Token Refresh Logic" as S2
        rectangle "Subtask: OAuth2 Client Config" as S3
        rectangle "Subtask: MFA Input Validation" as S4
        rectangle "Subtask: Analytics Query Optimization" as S5
        rectangle "Subtask: Dashboard Chart Components" as S6
    }
}

package "ðŸ¤– Agent Responsibilities" {

    rectangle "business-analyst" as BA <<Agent>> {
        note bottom
            **Epic Level Management:**
            â€¢ Epic creation & validation
            â€¢ Stakeholder requirements
            â€¢ Business value assessment
            â€¢ Epic â†’ Feature handoff
        end note
    }

    rectangle "product-manager" as PM <<Agent>> {
        note bottom
            **Feature Level Management:**
            â€¢ Epic â†’ Feature breakdown
            â€¢ Feature prioritization
            â€¢ MVP scoping & planning
            â€¢ Feature â†’ Task handoff
        end note
    }

    rectangle "software-architect" as SA <<Agent>> {
        note bottom
            **Task Level Management:**
            â€¢ Feature â†’ Task breakdown
            â€¢ Technical architecture design
            â€¢ Component planning
            â€¢ Task â†’ Subtask handoff
        end note
    }

    rectangle "Implementation Agents" as IA <<Agent>> {
        note bottom
            **Subtask Level Execution:**
            â€¢ Task â†’ Subtask breakdown
            â€¢ Concrete implementation
            â€¢ Code development
            â€¢ Testing & validation
        end note

        rectangle "frontend-engineer\napi-engineer\ndata-engineer" as ImplDetail
    }

    rectangle "qa-engineer\nsecurity-engineer\nreviewer" as QA <<Agent>> {
        note bottom
            **Cross-Level Validation:**
            â€¢ Quality gates at all levels
            â€¢ Cross-agent coordination
            â€¢ Process compliance
            â€¢ Final validation & approval
        end note
    }
}

package "âœ… TodoWrite Tool Integration" {

    rectangle "Session-Level TODO Management" as SessionTODO <<TodoWrite>> {
        note bottom
            **TodoWrite Tool Usage:**
            â€¢ Real-time task tracking
            â€¢ Status: pending/in_progress/completed
            â€¢ Cross-agent coordination
            â€¢ Progress visibility
        end note

        rectangle "TodoWrite Examples:" as Examples
        rectangle "â€¢ content: 'Implement JWT validation'\nâ€¢ status: 'in_progress'\nâ€¢ activeForm: 'Implementing JWT validation'" as Ex1
        rectangle "â€¢ content: 'Design OAuth2 architecture'\nâ€¢ status: 'completed'\nâ€¢ activeForm: 'Designing OAuth2 architecture'" as Ex2
    }
}

package "ðŸ”„ Workflow Coordination" {

    rectangle "Epic â†’ Feature Handoff" as EF_Handoff {
        note bottom
            **business-analyst â†’ product-manager**
            â€¢ Epic completion validation
            â€¢ Feature breakdown initiation
            â€¢ Requirements transfer
        end note
    }

    rectangle "Feature â†’ Task Handoff" as FT_Handoff {
        note bottom
            **product-manager â†’ software-architect**
            â€¢ Feature specification transfer
            â€¢ Technical feasibility validation
            â€¢ Architecture planning initiation
        end note
    }

    rectangle "Task â†’ Subtask Handoff" as TS_Handoff {
        note bottom
            **software-architect â†’ implementation agents**
            â€¢ Technical specifications transfer
            â€¢ Development task assignment
            â€¢ Implementation coordination
        end note
    }

    rectangle "Quality Gate Validation" as QG_Validation {
        note bottom
            **qa-engineer + security-engineer + reviewer**
            â€¢ Cross-level quality validation
            â€¢ Process compliance checks
            â€¢ Final approval coordination
        end note
    }
}

' Relationships
Epic ||--|| Feature : "Epic â†’ Feature\nBreakdown"
Feature ||--|| Task : "Feature â†’ Task\nDecomposition"
Task ||--|| Subtask : "Task â†’ Subtask\nImplementation"

BA ||--|| Epic : "Creates &\nManages"
PM ||--|| Feature : "Creates &\nManages"
SA ||--|| Task : "Creates &\nManages"
IA ||--|| Subtask : "Executes &\nCompletes"
QA ||--|| Epic : "Validates"
QA ||--|| Feature : "Validates"
QA ||--|| Task : "Validates"
QA ||--|| Subtask : "Validates"

Epic --> EF_Handoff
Feature --> FT_Handoff
Task --> TS_Handoff
Subtask --> QG_Validation

SessionTODO --> Epic : "Tracks"
SessionTODO --> Feature : "Tracks"
SessionTODO --> Task : "Tracks"
SessionTODO --> Subtask : "Tracks"

note top of Epic
    **CLAUDE.md Section 8 Configuration:**
    â€¢ todo_management_enabled: true
    â€¢ todo_hierarchy_level: hierarchical
    â€¢ auto_task_creation: true
    â€¢ agent_coordination: true
end note

note bottom of Subtask
    **TodoWrite Integration Pattern:**
    1. Mark exactly ONE task as 'in_progress'
    2. Complete tasks immediately after finishing
    3. Use descriptive content & activeForm
    4. Coordinate handoffs via status updates
end note

@enduml